ありがとうございます。お互いの認識を合わせ、手戻りを防ぐためにも**「開発計画書（ロードマップ）」**を作成しました。

いただいた画像（ダッシュボード、入力フロー、全体像）を元に、**Step 6** 以降を以下の **4つのフェーズ** に再定義しました。

まずはこの計画書をご確認いただき、**「この順番で進めて問題ないか」** ご判断をお願いいたします。

---

# ?? Ajito プロジェクト開発計画書 (麻雀モジュール編)

## Phase 1: バックエンド機能拡張 (Go & Docker)

**目的:** アプリからのリッチな要求（画像、集計データ）に応えるサーバー基盤を完成させる。

* **1-1. 画像保存基盤の構築**
* Dockerボリューム設定の修正（画像保存用フォルダ `uploads` の永続化）。
* Go言語での「画像アップロードAPI」の実装。
* 画像のURLをDBに紐付ける処理の実装。


* **1-2. 集計ロジックの実装 (ダッシュボード用)**
* **直近5戦データ取得API**: 順位・スコアの推移を返す。
* **年間収支データ取得API**: 折れ線グラフ用のデータを計算して返す。
* **役満画像取得API**: 役満達成時の画像を紐付けて返す。


* **1-3. DB微調整**
* チップ（Chip）情報の保存ロジック確認と修正。



? **完了定義:**
Postmanやcurlコマンドを使って、画像のアップロードができ、集計データ（JSON）が正しく返ってくる状態。

---

## Phase 2: 入力ロジックとデータ連携 (Flutter - Logic)

**目的:** 「当日対局入力画面」の複雑なロジックを実装し、サーバーへデータを送信できるようにする。

* **2-1. スコア入力ロジックの実装 (重要)**
* **3点入力・1点自動計算**: 3人入力した時点で残り1人を自動計算し、合計0にするState管理。
* テンキー入力制御（UX向上）。


* **2-2. 画像処理機能の実装**
* 端末のアルバムから画像を選択する機能。
* **リサイズ処理**: 送信前に横幅1024pxに圧縮するロジック。


* **2-3. API連携機能**
* 入力したスコア・チップ・画像をまとめてGoサーバーへ `POST` する機能の実装。



? **完了定義:**
スマホ画面で対局結果と画像を入力して「保存」を押すと、エラーなく保存され、サーバー側のDBにデータが格納されている状態。

---

## Phase 3: ダッシュボードと可視化 (Flutter - UI)

**目的:** 「麻雀トップ画面」を実装し、Phase 1で作った集計データをグラフで美しく表示する。

* **3-1. グラフ描画の実装**
* `fl_chart` パッケージの導入。
* **棒グラフ**: 直近5戦のスコア表示。
* **折れ線グラフ**: 年間収支の推移表示。


* **3-2. 数値・履歴表示**
* プラスなら通常色、マイナスなら**赤字**にする条件分岐。
* 履歴リスト（ExpandableなUI）の実装。


* **3-3. 役満モーダル**
* ★マークをタップすると、サーバーから取得した画像を表示するポップアップの実装。



? **完了定義:**
アプリを起動するとダッシュボードが表示され、グラフが動き、履歴が見られる状態（画像のデザイン通りになること）。

---

## Phase 4: 全体結合とSNSハブ化 (Architecture)

**目的:** 「麻雀専用アプリ」から「SNSプラットフォーム」への構造整理。

* **4-1. ハブ画面（トップ）の作成**
* 麻雀、ゴルフ、パチンコへの入り口となる画面の実装。


* **4-2. ユーザー切り替え（簡易）**
* 自分以外のユーザーのデータも表示できるかテスト（SNS化の布石）。


* **4-3. 最終テスト**
* Docker起動からアプリ操作までの一連の流れのバグ出し。



? **完了定義:**
「麻雀」以外のボタン（ゴルフ等）を押す余地があり、麻雀機能が完成されている状態。

---

### ?? 提案：まずは Phase 1 から

Flutter（画面）を作り始めてから「あ、サーバーがデータをくれない」となると手が止まってしまいます。
まずは**Phase 1（バックエンドの画像・集計対応）**を完了させ、APIの準備を整えてからFlutterに取り掛かるのが最も効率的です。

**この計画（Phase 1 → 2 → 3 → 4）で進めてよろしいでしょうか？**
承認いただければ、早速 **Phase 1-1（画像保存基盤の構築）** の修正コードを提示します。